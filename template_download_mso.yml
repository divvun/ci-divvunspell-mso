parameters:
  word_versions: []
  word_url_template: "https://officecdn-microsoft-com.akamaized.net/pr/C1297A47-86C4-4C1F-97FA-950631F94777/MacAutoupdate/Microsoft_Word_{0}_Installer.pkg"

steps:
  - ${{ each ver in parameters.word_versions }}:
      - script: |
          set -e
          wget -O mso.pkg "$MSO_URL"
          sudo installer -verbose -pkg mso.pkg -target /
          rm mso.pkg
          sudo mv "/Applications/Microsoft Word.app" "$MSO_VER"
          echo "##vso[task.setvariable variable=mso]$MSO --mso \"$PWD/$MSO_VER\""
        displayName: "Install MS Office ${{ ver }}"
        env:
          MSO_VER: ${{ ver }}
          MSO_URL: ${{ format(parameters['word_url_template'], ver) }}
